<ion-content [fullscreen]="true">

  <!-- TOP TABS -->
  <div class="top-tabs">
    <button (click)="tab = 'exercise'" [class.active]="tab === 'exercise'">
      Add Exercise
    </button>
    <button (click)="tab = 'workout'" [class.active]="tab === 'workout'">
      Add Workout
    </button>
  </div>

  <!-- ADD EXERCISE -->
  <ng-container *ngIf="tab === 'exercise'">
    <h2>Add New Exercise</h2>

    <form [formGroup]="exerciseForm" class="neon-form">

      <ion-item>
        <ion-label position="stacked">Exercise Name</ion-label>
        <ion-input formControlName="name"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Description</ion-label>
        <ion-input formControlName="description"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Sets</ion-label>
        <ion-input type="number" formControlName="sets"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Repetitions</ion-label>
        <ion-input type="number" formControlName="reps"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Rest Between Sets</ion-label>
        <ion-input type="number" formControlName="restBetweenSets"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Rest After Exercise</ion-label>
        <ion-input type="number" formControlName="restAfterExercise"></ion-input>
      </ion-item>

      <div class="video-upload">
        <label for="videoInput">Choose Video</label>
        <input id="videoInput" type="file" accept="video/*" (change)="onVideoSelected($event)" />
      </div>

      <ion-button expand="block" color="tertiary" (click)="saveExercise()">
        <ion-spinner *ngIf="isSavingExercise" name="crescent"></ion-spinner>
        <span *ngIf="!isSavingExercise">Add Exercise</span>
      </ion-button>

    </form>
  </ng-container>

  <!-- ADD WORKOUT -->
  <ng-container *ngIf="tab === 'workout'">

    <h2>Create Workout</h2>

    <div class="neon-form">

      <ion-item>
        <ion-label position="stacked">Title</ion-label>
        <ion-input [(ngModel)]="newWorkout.title"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Category</ion-label>
        <ion-input [(ngModel)]="newWorkout.subtitle"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Description</ion-label>
        <ion-input [(ngModel)]="newWorkout.content"></ion-input>
      </ion-item>
    </div>

    <h3>Exercises in Workout</h3>

    <ion-reorder-group [disabled]="false" (ionItemReorder)="handleReorder($event)">
      <ion-item *ngFor="let ex of editableExercises; let i = index">
        <ion-reorder slot="start"></ion-reorder>
        <ion-label>{{ ex.name }}</ion-label>

        <ion-button fill="outline" color="danger" (click)="removeExercise(i)">
          Remove
        </ion-button>
      </ion-item>
    </ion-reorder-group>

    <h3>Add Exercise</h3>

    <ion-searchbar
      [(ngModel)]="searchQuery"
      (ionInput)="onSearch($event)"
      placeholder="Search..."
      animated="true">
    </ion-searchbar>

    <ion-list>
      <ion-item *ngFor="let ex of filteredExercises">
        <ion-label>{{ ex.name }}</ion-label>
        <ion-button fill="outline" (click)="addExercise(ex)">Add</ion-button>
      </ion-item>
    </ion-list>

    <ion-button expand="block" color="success" (click)="saveNewWorkout()" [disabled]="isSavingWorkout">
      <ion-spinner *ngIf="isSavingWorkout" name="crescent"></ion-spinner>
      <span *ngIf="!isSavingWorkout">Create Workout</span>
    </ion-button>

  </ng-container>

</ion-content>
