<ion-content [fullscreen]="true">

  <div *ngIf="isUploading" class="upload-fallback">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Uploading... Please wait</p>
  </div>

  <h2>Add New Workout</h2>

  <div class="form-wrapper">
    <form [formGroup]="workoutForm">

      <ion-item>
        <ion-label position="stacked">Workout Title</ion-label>
        <ion-input formControlName="title"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Description</ion-label>
        <ion-input formControlName="content"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Category</ion-label>
        <ion-input formControlName="subtitle"></ion-input>
      </ion-item>

      <!-- DRAG & DROP LISTA VEÅ½BI -->
      <h3 class="modal-section-title">Exercises</h3>

      <ion-reorder-group [disabled]="false" (ionItemReorder)="handleReorder($event)">
        <ion-item *ngFor="let ex of editableExercises; let i = index">

          <ion-reorder slot="start"></ion-reorder>

          <ion-label>{{ ex.name }}</ion-label>

          <ion-button color="danger" fill="outline" (click)="removeExercise(i)">
            Remove
          </ion-button>

        </ion-item>
      </ion-reorder-group>

      <ion-accordion-group expand="inset">
        <ion-accordion value="exercise-list">

          <!-- HEADER -->
          <ion-item slot="header" class="accordion-header-glass">
            <ion-label>Available Exercises</ion-label>
          </ion-item>

          <!-- CONTENT -->
          <div slot="content" class="accordion-content">

            <!-- ðŸ” SEARCH BAR -->
            <ion-searchbar [value]="exerciseSearch" (ionInput)="onSearchChange($event)"
              placeholder="Search exercises..." debounce="150">
            </ion-searchbar>

            <!-- ðŸ“‹ FILTERED LIST -->
            <ion-list>
              <ion-item *ngFor="let ex of filteredExercises">
                <ion-label>{{ ex.name }}</ion-label>
                <ion-button fill="outline" (click)="addExercise(ex)">
                  Add
                </ion-button>
              </ion-item>
            </ion-list>

          </div>

        </ion-accordion>
      </ion-accordion-group>


      <ion-button expand="block" color="success" (click)="saveWorkout()">
        Save Workout
      </ion-button>

    </form>
  </div>

  <hr />

  <h2>Add New Exercise</h2>

  <form [formGroup]="exerciseForm">
    <ion-item>
      <ion-label position="stacked">Exercise Name</ion-label>
      <ion-input formControlName="name"></ion-input>
    </ion-item>

    <ion-item>
      <ion-label position="stacked">Description</ion-label>
      <ion-input formControlName="description"></ion-input>
    </ion-item>

    <ion-item>
      <ion-label position="stacked">Sets 1-10</ion-label>
      <ion-input type="number" formControlName="sets"></ion-input>
    </ion-item>

    <ion-item>
      <ion-label position="stacked">Repetitions 1-100</ion-label>
      <ion-input type="number" formControlName="reps"></ion-input>
    </ion-item>

    <ion-item>
      <ion-label position="stacked">Rest Between Sets</ion-label>
      <ion-input type="number" formControlName="restBetweenSets"></ion-input>
    </ion-item>

    <ion-item>
      <ion-label position="stacked">Rest After Exercise</ion-label>
      <ion-input type="number" formControlName="restAfterExercise"></ion-input>
    </ion-item>

    <div class="video-upload">
      <label for="videoInput">Choose Video File</label>
      <input id="videoInput" type="file" accept="video/*" (change)="onVideoSelected($event)" />
    </div>

    <ion-button expand="block" color="tertiary" (click)="saveExercise()">
      Add Exercise
    </ion-button>
  </form>

</ion-content>